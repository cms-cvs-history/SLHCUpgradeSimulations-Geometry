process VALID  = 
{
  service =  RandomNumberGeneratorService {
    untracked uint32 sourceSeed = 123456789
	# This is to initialize the random engine of Famos
	# Watch out! This works only if the FamosProducer label is "Famos"
    PSet moduleSeeds =
    {
	    # untracked uint32 VtxSmeared = 123456789
      untracked uint32 famosSimHits = 13579
      untracked uint32 siTrackerGaussianSmearingRecHits = 24680
      untracked uint32 famosPileUp = 234561	
      untracked uint32 MuonSimHits = 54653
    }
  }

  untracked PSet options = {
            include "FWCore/Framework/test/cmsExceptionsFatalOption.cff"
            untracked bool wantSummary = true
  }
  
  untracked PSet maxEvents = {untracked int32 input = 10000}

  service = Timing { }
  
  source = FlatRandomPtGunSource 
  {	 
    untracked uint32 firstRun  = 1
    untracked      PSet  PGunParameters =
    {
      untracked vint32 PartID = {13} 
      untracked double MinEta = -2.5
      untracked double MaxEta = 2.5
      untracked double MinPhi = -3.14159265358979323846  # it must be in radians
      untracked double MaxPhi =  3.14159265358979323846
      untracked double MinPt   = 50.0
      untracked double MaxPt   = 50.0
    }      
    untracked int32 Verbosity = 0 # for printouts, set it to 1 (or greater)   
  }	
  
    # Famos sequences
  include "FastSimulation/Configuration/data/CommonInputsFake.cff"
  include "FastSimulation/Configuration/data/FamosSequences.cff"
  # replace the standard geometry include
  include "SLHCUpgradeSimulations/Geometry/data/strawmanb/replace_cmsIdealGeometryXML.cfi"

  // If you want to turn on/off pile-up
  replace famosPileUp.PileUpSimulator.averageNumber = 0.0

  replace VolumeBasedMagneticFieldESProducer.useParametrizedTrackerField = true
  replace famosSimHits.SimulateCalorimetry = false
  replace famosSimHits.SimulateTracking = true

  module o1 = PoolOutputModule { untracked string fileName = "/uscms_data/d1/cheung/slhc/test_muon_50GeV.root" }
  
    # Tracking particle module
  include "SimGeneral/TrackingAnalysis/data/trackingParticles.cfi"
  replace trackingtruthprod.TrackerHitLabels = {"TrackerHits"}
  
    # Track Validator    
  //include "Validation/RecoTrack/data/cutsTPEffic.cfi"
  //include "Validation/RecoTrack/data/cutsTPFake.cfi"
  include "SLHCUpgradeSimulations/Geometry/data/cutsTPEffic.cfi"
  include "SLHCUpgradeSimulations/Geometry/data/cutsTPFake.cfi"
  include "FastSimulation/Tracking/data/cutsGS.cfi"
  include "Validation/RecoTrack/data/MultiTrackValidator.cff"
  replace multiTrackValidator.label = {cutsGS}	
  replace multiTrackValidator.out = "valid_muon_50GeV.root"	
  
    # Track Associators
  include "SimTracker/TrackAssociation/data/TrackAssociatorByChi2.cfi"
  include "SimTracker/TrackAssociation/data/TrackAssociatorByHits.cfi"
  replace TrackAssociatorByHitsESProducer.associateStrip = false 
  replace TrackAssociatorByHitsESProducer.associatePixel = false
  replace TrackAssociatorByHitsESProducer.ROUList = {"TrackerHits"}
  
  path p1 = { 
    famosWithTracks, 
    trackerGSRecHitTranslator,
    trackingtruthprod,
    cutsTPEffic, 
    cutsTPFake,
    cutsGS,	
    multiTrackValidator	
  }
  
  endpath outpath = { o1 }
  
    # Keep the logging output to a nice level #
  include "FWCore/MessageService/data/MessageLogger.cfi"
  replace MessageLogger.destinations = {"detailedInfo_mu50.txt"}
}		
